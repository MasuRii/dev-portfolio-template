---
import { Image } from 'astro:assets';
import type { BlogPost } from '../../../types/blog';
import { ShareButtons } from '../../ui/ShareButtons';

interface Props {
  post: BlogPost;
}

const { post } = Astro.props;
---

<article
  class="group relative flex flex-col overflow-hidden rounded-2xl border border-border bg-background transition-all duration-300 hover:-translate-y-2 hover:border-accent hover:shadow-2xl"
  data-testid="blog-card"
>
  <div class="aspect-video overflow-hidden">
    <Image
      src={post.image}
      alt={post.title}
      width={800}
      height={450}
      format="avif"
      widths={[400, 800]}
      sizes="(max-width: 768px) 400px, 800px"
      class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-110"
      loading="lazy"
      decoding="async"
    />
  </div>

  <div class="flex flex-1 flex-col p-6">
    <div class="mb-4 flex flex-wrap gap-2">
      {
        post.tags.map((tag) => (
          <span class="rounded-full bg-surface px-3 py-1 text-xs font-medium text-secondary border border-border">
            {tag}
          </span>
        ))
      }
    </div>

    <h3
      class="mb-3 font-display text-xl font-bold leading-tight text-primary transition-colors group-hover:text-accent"
    >
      <a href={post.url}>
        <span class="absolute inset-0"></span>
        {post.title}
      </a>
    </h3>

    <p class="mb-6 line-clamp-3 flex-1 text-sm leading-relaxed text-secondary">
      {post.excerpt}
    </p>

    <div
      class="flex items-center justify-between border-t border-border pt-4 text-xs font-medium text-muted"
    >
      <div class="flex items-center gap-4">
        <time datetime={post.date}>
          {
            new Date(post.date).toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric',
            })
          }
        </time>
        <span>{post.readTime}</span>
      </div>
      <div class="relative z-10">
        <ShareButtons
          client:visible
          title={post.title}
          url={post.url}
          excerpt={post.excerpt}
        />
      </div>
    </div>
  </div>
</article>
